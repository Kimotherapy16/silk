<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Silk | Orders</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <style>
    body {
      background-color: #121212;
      color: white;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    .navbar {
      background-color: #1f1f1f;
    }

    .navbar-brand {
      color: #00bcd4;
      font-weight: bold;
    }

    .navbar-brand:hover {
      color: #00acc1;
    }

    .nav-link {
      color: white;
    }

    .nav-link:hover {
      color: #00bcd4;
    }

    .search-bar, .filter-status {
      background-color: #1f1f1f;
      border-radius: 0.5rem;
      padding: 1rem;
      margin-bottom: 1rem;
    }

    .order-card {
      background-color: #1f1f1f;
      border-radius: 0.5rem;
      padding: 1rem;
      box-shadow: 0 0 10px rgba(0,0,0,0.3);
      cursor: pointer;
      transition: transform 0.2s;
    }

    .order-card:hover {
      transform: scale(1.02);
      box-shadow: 0 0 15px rgba(0, 188, 212, 0.4);
    }

    .form-control, .form-select {
      background-color: #2b2b2b;
      color: white;
      border: none;
    }

    .form-control:focus, .form-select:focus {
      border-color: #00bcd4;
      box-shadow: 0 0 0 0.2rem rgba(0,188,212,0.25);
    }

    .order-details {
      background-color: #2b2b2b;
      padding: 2rem;
      border-radius: 1rem;
      box-shadow: 0 0 15px rgba(0,0,0,0.3);
    }

    .order-items {
      margin-bottom: 1rem;
    }

    .order-item {
      margin-bottom: 0.5rem;
    }

    .order-status {
      background-color: #00bcd4;
      padding: 0.5rem;
      border-radius: 0.25rem;
      color: white;
    }
  </style>
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-dark px-3">
    <a class="navbar-brand" href="seller-dashboard.html">Silk</a>
    <div class="collapse navbar-collapse">
      <ul class="navbar-nav ms-auto">
        <li class="nav-item"><a class="nav-link" href="seller-dashboard.html">Home</a></li>
        <li class="nav-item"><a class="nav-link" href="add-product.html">Add Products</a></li>
        <li class="nav-item"><a class="nav-link" href="product.html">My Products</a></li>
        <li class="nav-item"><a class="nav-link" href="orders.html">Orders</a></li>
        <li class="nav-item"><a class="nav-link" href="pos.html">Manual POS</a></li>
        <li class="nav-item"><a class="nav-link" href="seller-profile.html">Profile</a></li>
        <li class="nav-item"><a class="nav-link" href="index.html">Logout</a></li>
      </ul>
    </div>
  </nav>

  <div class="container mt-4">
    <!-- Search and Filter Section -->
    <div class="search-bar d-flex gap-3 flex-wrap">
      <input type="text" id="search-input" class="form-control w-100 w-md-50" placeholder="Search by customer or order ID...">
      <select id="sort-select" class="form-select w-100 w-md-25">
        <option value="">Sort by</option>
        <option value="date-asc">Date: Oldest First</option>
        <option value="date-desc">Date: Newest First</option>
        <option value="status-pending">Status: Pending</option>
        <option value="status-shipped">Status: Shipped</option>
        <option value="status-delivered">Status: Delivered</option>
      </select>
      <select id="status-filter" class="form-select w-100 w-md-25">
        <option value="">Filter by Status</option>
        <option value="pending">Pending</option>
        <option value="shipped">Shipped</option>
        <option value="delivered">Delivered</option>
      </select>
    </div>

    <div class="row g-4" id="order-list">
   
    </div>
  </div>
 <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.0.0/dist/umd/supabase.min.js"></script>

  <script>
    const SUPABASE_URL = "https://dihzhshukgwduxatoyrj.supabase.co";
    const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRpaHpoc2h1a2d3ZHV4YXRveXJqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDE3NTExMzEsImV4cCI6MjA1NzMyNzEzMX0.EuyuH4VVV92bb44-x59rs9id5eSNA-CU6guMkCP74Vc"; 
    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    const searchInput = document.getElementById("search-input");
    const sortSelect = document.getElementById("sort-select");
    const statusFilter = document.getElementById("status-filter");
    const orderList = document.getElementById("order-list");

    // Fetch orders from Supabase
    async function fetchOrders() {
      try {
        let query = supabase
          .from("orders")
          .select("*")
          .order("order_date", { ascending: false });

        // Handle filters
        if (statusFilter.value) {
          query = query.eq("status", statusFilter.value);
        }

        if (searchInput.value) {
          query = query.ilike("customer_name", `%${searchInput.value}%`);
        }

        const { data, error } = await query;

        if (error) throw error;

        displayOrders(data); // Pass data to display in HTML
      } catch (error) {
        console.error("Error fetching orders:", error);
      }
    }

    // Display orders on the page
    function displayOrders(orders) {
      orderList.innerHTML = ""; // Clear current order list

      orders.forEach(order => {
        const orderCard = document.createElement("div");
        orderCard.classList.add("col-md-4");
        orderCard.innerHTML = `
          <div class="order-card" onclick="window.location.href='order-details.html?id=${order.order_id}'">
            <h5>Order #${order.order_id}</h5>
            <p class="text-muted">Customer: ${order.customer_name}</p>
            <p class="text-muted">Status: <span class="order-status">${order.status}</span></p>
            <p class="text-muted">Date: ${new Date(order.order_date).toLocaleDateString()}</p>
          </div>
        `;
        orderList.appendChild(orderCard);
      });
    }

    // Event Listeners
    searchInput.addEventListener("input", fetchOrders);
    sortSelect.addEventListener("change", fetchOrders);
    statusFilter.addEventListener("change", fetchOrders);

    // Initial fetch
    fetchOrders();
  </script>

</body>
</html>
